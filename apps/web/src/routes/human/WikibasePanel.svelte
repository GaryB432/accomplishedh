<script lang="ts">
  import HorizontalPanel from '$lib/components/bases/HorizontalPanel.svelte';
  import WikidataAnchor from '$lib/components/wikidata/Anchor.svelte';
  import Awards from '$lib/components/wikidata/Awards.svelte';
  import Lifespan from '$lib/components/wikidata/Lifespan.svelte';
  import {
    labelify,
    summarize,
    type Entity,
  } from '@accomplishedh/wikibase';
  import Aliases from './wikibase-entity/Aliases.svelte';
  import SiteLinks from './wikibase-entity/SiteLinks.svelte';

  type Props = { entity: Entity };

  let { entity }: Props = $props();

  let doSummarize = $derived(summarize(entity));
</script>

<article>
  {#await doSummarize}
    hang on&hellip;
  {:then summarized_entity}
    <div class="heading">
      <div class="announce">
        <svg width="17px" height="17px" viewBox="0 0 17 17">
          <path
            d="M16.469 2.222h-1.927c-0.292 0-0.531 0.234-0.531 0.521v0.667l-10.995 4.030v-0.27c0-0.43-0.358-0.781-0.797-0.781h-1.422c-0.439 0-0.797 0.351-0.797 0.781v4.688c0 0.429 0.358 0.781 0.797 0.781h1.422c0.438 0 0.797-0.352 0.797-0.781v-0.331l1.034 0.189c-0.023 0.163-0.038 0.326-0.038 0.491 0 1.897 1.561 3.441 3.479 3.441 1.657 0 3.030-1.128 3.38-2.682l3.14 0.576v0.659c0 0.287 0.239 0.521 0.531 0.521h1.927c0.292 0 0.531-0.234 0.531-0.521v-11.458c0-0.287-0.239-0.521-0.531-0.521zM7.491 14.648c-1.367 0-2.479-1.095-2.479-2.441 0-0.104 0.027-0.205 0.040-0.308l4.84 0.888c-0.264 1.082-1.235 1.861-2.401 1.861zM16 13.722h-0.989v-1.013l-12.995-2.383v1.312h-1.016v-4.25h1.016v1.484l12.995-4.763v-0.887h0.989v10.5z"
          />
        </svg>

        <svg
          id="bulb"
          width="64px"
          height="64px"
          viewBox="0 0 32 32"
          enable-background="new 0 0 32 32"
          xml:space="preserve"
          fill="#000000"
          ><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g
            id="SVGRepo_tracerCarrier"
            stroke-linecap="round"
            stroke-linejoin="round"
          ></g><g id="SVGRepo_iconCarrier">
            <path
              fill="#31CFFF"
              d="M29,23.5c0,0.28-0.22,0.5-0.5,0.5H28v0.5c0,0.28-0.22,0.5-0.5,0.5S27,24.78,27,24.5V24h-0.5 c-0.28,0-0.5-0.22-0.5-0.5s0.22-0.5,0.5-0.5H27v-0.5c0-0.28,0.22-0.5,0.5-0.5s0.5,0.22,0.5,0.5V23h0.5C28.78,23,29,23.22,29,23.5z"
            ></path>
            <path
              fill="#5FFFBA"
              d="M8,24.5C8,24.78,7.78,25,7.5,25H6v1.5C6,26.78,5.78,27,5.5,27S5,26.78,5,26.5V25H3.5C3.22,25,3,24.78,3,24.5 S3.22,24,3.5,24H5v-1.5C5,22.22,5.22,22,5.5,22S6,22.22,6,22.5V24h1.5C7.78,24,8,24.22,8,24.5z"
            ></path>
            <path
              fill="#5FFFBA"
              d="M30,5.5C30,5.78,29.78,6,29.5,6H28v1.5C28,7.78,27.78,8,27.5,8S27,7.78,27,7.5V6h-1.5 C25.22,6,25,5.78,25,5.5S25.22,5,25.5,5H27V3.5C27,3.22,27.22,3,27.5,3S28,3.22,28,3.5V5h1.5C29.78,5,30,5.22,30,5.5z"
            ></path>
            <path
              fill="#31CFFF"
              d="M7,5.5C7,5.78,6.78,6,6.5,6H6v0.5C6,6.78,5.78,7,5.5,7S5,6.78,5,6.5V6H4.5C4.22,6,4,5.78,4,5.5S4.22,5,4.5,5 H5V4.5C5,4.22,5.22,4,5.5,4S6,4.22,6,4.5V5h0.5C6.78,5,7,5.22,7,5.5z"
            ></path>
            <path
              fill="#FFD561"
              d="M22.96,10.73c-0.02-0.24-0.06-0.48-0.11-0.71c0-0.01,0-0.01,0-0.02c-0.42-2.13-1.76-3.94-3.58-5 c-0.14-0.09-0.289-0.16-0.439-0.23c-0.23-0.12-0.46-0.22-0.7-0.31c-0.33-0.12-0.67-0.23-1.02-0.3c-0.2-0.05-0.4-0.08-0.601-0.11 H16.5C12.83,4.54,10,7.68,10,11.48c0,1.37,0.36,2.65,1,3.75c0.65,1.13,1.91,3.01,3,4.6v-5.92C13.84,13.96,13.68,14,13.5,14 c-0.83,0-1.5-0.67-1.5-1.5s0.67-1.5,1.5-1.5s1.5,0.67,1.5,1.5V21h1v-8.5c0-0.83,0.67-1.5,1.5-1.5c0.68,0,1.25,0.45,1.43,1.07 C19.55,12.25,20,12.82,20,13.5c0,0.83-0.67,1.5-1.5,1.5c-0.18,0-0.34-0.03-0.5-0.09V21h0.19c0.76-1.09,1.75-2.54,2.59-3.82 c0.1-0.14,0.189-0.28,0.27-0.42c0.38-0.58,0.71-1.11,0.95-1.53c0.64-1.1,1-2.38,1-3.75C23,11.22,22.99,10.98,22.96,10.73z"
            ></path>
            <g>
              <path
                fill="#2D2220"
                d="M22.03,6H20.6c0.891,0.81,1.57,1.84,1.971,3h1.069C23.31,7.89,22.76,6.87,22.03,6z"
              ></path>
              <path
                fill="#BCBCBC"
                d="M18,22c0,0,0,0.41,0,1h-3c0-0.59,0-1,0-1H18z"
              ></path>
              <rect x="15" y="24" fill="#BCBCBC" width="3" height="1"></rect>
              <path
                fill="#BCBCBC"
                d="M15,26h3v0.95c0,0.71-0.76,1.39-1.5,1.76c-0.74-0.37-1.5-1.05-1.5-1.76V26z"
              ></path>
            </g>
            <path
              fill="#2D2220"
              d="M28,22.5c0,0.28-0.22,0.5-0.5,0.5H27v0.5c0,0.28-0.22,0.5-0.5,0.5S26,23.78,26,23.5V23h-0.5 c-0.28,0-0.5-0.22-0.5-0.5s0.22-0.5,0.5-0.5H26v-0.5c0-0.28,0.22-0.5,0.5-0.5s0.5,0.22,0.5,0.5V22h0.5C27.78,22,28,22.22,28,22.5z"
            ></path>
            <path
              fill="#2D2220"
              d="M7,23.5C7,23.78,6.78,24,6.5,24H5v1.5C5,25.78,4.78,26,4.5,26S4,25.78,4,25.5V24H2.5C2.22,24,2,23.78,2,23.5 S2.22,23,2.5,23H4v-1.5C4,21.22,4.22,21,4.5,21S5,21.22,5,21.5V23h1.5C6.78,23,7,23.22,7,23.5z"
            ></path>
            <path
              fill="#2D2220"
              d="M29,4.5C29,4.78,28.78,5,28.5,5H27v1.5C27,6.78,26.78,7,26.5,7S26,6.78,26,6.5V5h-1.5 C24.22,5,24,4.78,24,4.5S24.22,4,24.5,4H26V2.5C26,2.22,26.22,2,26.5,2S27,2.22,27,2.5V4h1.5C28.78,4,29,4.22,29,4.5z"
            ></path>
            <path
              fill="#2D2220"
              d="M6,4.5C6,4.78,5.78,5,5.5,5H5v0.5C5,5.78,4.78,6,4.5,6S4,5.78,4,5.5V5H3.5C3.22,5,3,4.78,3,4.5S3.22,4,3.5,4 H4V3.5C4,3.22,4.22,3,4.5,3S5,3.22,5,3.5V4h0.5C5.78,4,6,4.22,6,4.5z"
            ></path>
            <path
              fill="#2D2220"
              d="M22.87,15.68c0.72-1.25,1.13-2.7,1.13-4.24c0-0.49-0.04-0.97-0.12-1.44h-1.03C22.95,10.48,23,10.97,23,11.48 c0,1.37-0.36,2.65-1,3.75c-0.82,1.42-2.61,4.04-3.81,5.77H17v-7.09c0.16,0.05,0.32,0.09,0.5,0.09c0.83,0,1.5-0.67,1.5-1.5 S18.33,11,17.5,11S16,11.67,16,12.5V21h-1v-8.5c0-0.83-0.67-1.5-1.5-1.5S12,11.67,12,12.5s0.67,1.5,1.5,1.5 c0.18,0,0.34-0.04,0.5-0.09V21h-1.19c-1.2-1.73-2.99-4.35-3.81-5.77c-0.64-1.1-1-2.38-1-3.75c0-4.14,3.36-7.5,7.5-7.5 c1.37,0,2.65,0.37,3.75,1.02h1.79c-1.49-1.29-3.43-2.06-5.54-2.06c-4.69,0-8.5,3.81-8.5,8.5c0,1.54,0.41,2.99,1.13,4.24 c0.84,1.44,2.54,4.02,3.87,5.99V23h-0.5c-0.28,0-0.5,0.22-0.5,0.5s0.22,0.5,0.5,0.5H12v1h-0.5c-0.28,0-0.5,0.22-0.5,0.5 s0.22,0.5,0.5,0.5H12v0.95C12,28.5,14.29,30,15.5,30s3.5-1.5,3.5-3.05V26h0.5c0.28,0,0.5-0.22,0.5-0.5S19.78,25,19.5,25H19v-1h0.5 c0.28,0,0.5-0.22,0.5-0.5S19.78,23,19.5,23H19v-1.33C20.33,19.7,22.03,17.12,22.87,15.68z M17.5,11.99c0.27,0,0.49,0.23,0.49,0.5 c0,0.28-0.221,0.5-0.49,0.5s-0.49-0.22-0.49-0.5C17.01,12.22,17.23,11.99,17.5,11.99z M13.5,13c-0.27,0-0.49-0.23-0.49-0.5 c0-0.28,0.22-0.5,0.49-0.5s0.49,0.22,0.49,0.5C13.99,12.77,13.77,13,13.5,13z M18,26.95c0,0.71-0.76,1.39-1.5,1.76 c-0.36,0.18-0.72,0.29-1,0.29c-0.83,0-2.5-1-2.5-2.05V26h5V26.95z M18,25h-5v-1h5V25z M18,23h-5c0-0.59,0-1,0-1h5 C18,22,18,22.41,18,23z"
            ></path>
          </g>
        </svg>

        <div class="much_more">
          See much <a
            href={`https://wikidata.org/wiki/${entity.id}`}
            rel="external nofollow noopener noreferrer"
            target="_blank"
          >
            more about this individual</a
          >
          at
          <a
            rel="external nofollow noopener noreferrer"
            target="_blank"
            href="https://wikidata.org">wikidata.org</a
          >
        </div>
      </div>
      <div>
        <svg
          id="wikidata_mark"
          width="1052"
          height="744"
          viewBox="0 0 1052 744"
        >
          <path
            d="m 119.4207,543.01679 h 29.16277 V 43.052497 H 119.4207 V 543.01679 z m 60.27256,0 h 89.42926 V 43.052497 H 179.69326 V 543.01679 z M 298.29136,43.052497 V 542.99895 h 89.42926 V 43.052497 h -89.42926 z"
            style="fill:#990000"
          />
          <path
            d="m 838.97933,543.0524 h 29.16883 V 43.052437 H 838.97933 V 543.0524 z M 899.25795,43.052437 V 543.0524 h 29.16277 V 43.052437 H 899.25795 z M 417.85387,543.05247 h 29.16277 V 43.052497 H 417.85387 V 543.05247 z M 478.13249,43.052497 V 543.03463 h 29.16884 V 43.052497 h -29.16884 z"
            style="fill:#339966"
          />
          <path
            d="m 537.42244,543.05247 h 89.4414 V 43.052497 h -89.4414 V 543.05247 z m 118.5981,0 h 31.10372 V 43.052497 H 656.02054 V 543.05247 z M 716.2931,43.052497 V 543.03463 h 89.42926 V 43.052497 H 716.2931 z"
            style="fill:#006699"
          />
          <path
            d="m 883.98859,598.08811 46.01562,103.68359 -27.75781,0 -8.53516,-20.48438 -46.38672,0 -7.71875,20.48438 -27.38672,0 41.78516,-103.68359 29.98438,0 m 2.07812,65.08984 -16.69922,-40.30078 -15.21484,40.30078 31.91406,0 m -60.26562,-65.08984 0,19 -37.55469,0 0,84.68359 -25.82813,0 0,-84.68359 -37.55468,0 0,-19 100.9375,0 m -133.59375,0 46.01562,103.68359 -27.75781,0 -8.53516,-20.48438 -46.38672,0 -7.71875,20.48438 -27.38672,0 41.78516,-103.68359 29.98438,0 m 2.07812,65.08984 -16.69922,-40.30078 -15.21484,40.30078 31.91406,0 m -176.56641,-65.08984 45.71875,0 c 17.66399,10e-5 31.6171,4.84905 41.85938,14.54687 10.29156,9.64852 15.43739,22.142 15.4375,37.48047 -1.1e-4,16.08076 -5.22016,28.72268 -15.66016,37.92578 -10.39071,9.15365 -25.23444,13.73047 -44.53125,13.73047 l -42.82422,0 0,-103.68359 m 25.82813,19 0,65.68359 16.84766,0 c 10.93483,2e-5 19.2968,-2.99347 25.08593,-8.98047 5.78898,-6.03642 8.68351,-13.97782 8.6836,-23.82422 -9e-5,-10.19264 -2.9441,-18.20826 -8.83203,-24.04687 -5.83862,-5.88794 -14.25007,-8.83195 -25.23438,-8.83203 l -16.55078,0 m -49.72656,-19 0,103.68359 -25.82813,0 0,-103.68359 25.82813,0 m -48.91016,0 -33.76953,48.6875 45.79297,54.99609 -32.35938,0 -41.04297,-48.61328 0,48.61328 -25.82812,0 0,-103.68359 25.82812,0 0,46.68359 32.95313,-46.68359 28.42578,0 m -111.10547,0 0,103.68359 -25.82812,0 0,-103.68359 25.82812,0 m -127.21094,37.40625 -32.0625,67.61328 -11.13281,0 -45.57031,-105.01953 27.38672,0 24.41797,57.29687 26.64453,-57.29687 20.78125,0 26.64453,57.29687 24.26953,-57.29687 27.38672,0 -45.42188,105.01953 -11.13281,0 -32.21094,-67.61328"
            style="fill:#484848;fill-opacity:1;stroke:none;font-family:Gill Sans MT"
          />
        </svg>
      </div>
    </div>
    {@const { summary } = summarized_entity}

    <HorizontalPanel>
      <Lifespan entity={summarized_entity}></Lifespan>
      <Awards entity={summarized_entity}></Awards>
    </HorizontalPanel>

    <Aliases entity={summarized_entity}></Aliases>

    <SiteLinks entity={summarized_entity}></SiteLinks>

    {#await labelify(summary.claims)}
      props...
    {:then dictionary}
      <div class="claims-box">
        {#each Object.entries(summary.claims) as [wbid, property_value] (wbid)}
          <WikidataAnchor {wbid} text={dictionary[wbid]}></WikidataAnchor>
          <div>{property_value}</div>
        {/each}
      </div>
    {/await}
  {/await}
</article>

<style>
  article {
    --light-black: rgba(0, 0, 0, 0.2);
    box-shadow:
      0 2px 2px 0 var(--light-black),
      0 12px 22px 0 var(--light-black);
    outline: 1px solid var(--light-black);
    overflow: hidden;
    padding: 0.2em;
  }
  .heading,
  .announce {
    align-items: center;
  }
  .heading {
    justify-content: space-between;
    display: flex;
    & svg {
      width: 44px;
      height: 44px;
      flex: none;
    }
  }
  .announce {
    gap: 0.5em;
    display: flex;
  }
  .much_more {
    font-weight: bold;
  }
  .claims-box {
    border: thin solid silver;
    display: grid;
    grid-template-columns: min-content 1fr;
    align-items: center;
    gap: 1em;
  }
</style>
